## Сервер данных сердец

Сервер позволяет визуализации viewlang.ru получать данные с вычислителя:
* список каталогов сердец 
* файлы данных этих каталогов.

Внутри сервер состоит из двух частей:
* Поиск подходящих каталогов. 
* Http-сервер файлов данных.

Важно. Поиск и раздача файлов начинается от текущего каталога, где запущен сервер.
Поэтому его целесообразно запускать в `домашнем` каталоге пользователя, или глубже.

## Подготовка к запуску
Установить необходимые руби-пакеты, выполнив нижеследующие команды. Это действие проводится однократно.

```
gem install sinatra --user-install --no-ri --no-rdoc
gem install json --user-install --no-ri --no-rdoc
gem install thin --user-install --no-ri --no-rdoc
gem install sinatra-contrib --user-install --no-ri --no-rdoc
```

## Временный запуск
Команда запуска:
```
ruby /misc/home/u1321/heartsrv1/heart-server-1.rb
```
Примечание. Сервер уже размещен на машине UMT в каталоге /misc/home/u1321/heartsrv1/

Остановка сервера во временном запуске - Ctrl+C

## Постоянный запуск
Если требуется, чтобы сервер работал и после завершения SSH-сессии связи с UMT, команда запуска с амперсандом на конце:
```
ruby /misc/home/u1321/heartsrv1/heart-server-1.rb &
```

## Остановка
Алгоритм остановки сервера, запущенного в постоянном режиме:
```
ps ax|grep ruby
# найти глазами <айди процесса сервера>
kill <этот айди>
```

## Взаимодействие с сервером
Когда сервер работает, в диалоге "Загрузка данных.." доступна к использованию вкладка "Суперкомпьютер". 
* Кнопка `Опросить` формирует обращение к серверу на поиск данных. По окончанию поиска отображается список найденных каталогов и предлагается выбрать один из них.
* Кнопка `Загрузить выбор` - подает команду на загрузку выбранных данных.

2015 Павел Васёв
